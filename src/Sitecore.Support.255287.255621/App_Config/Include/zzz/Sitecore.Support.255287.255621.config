<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/" xmlns:set="http://www.sitecore.net/xmlconfig/set/" xmlns:role="http://www.sitecore.net/xmlconfig/role/">
  <sitecore role:require="Standalone or ContentManagement">
    <services role:require="Standalone or ContentManagement">
      <register role:require="!DedicatedDispatch"
        serviceType="Sitecore.Framework.Messaging.IMessageHandler`1[[Sitecore.EmailCampaign.Model.Messaging.UnsubscribeMessage, Sitecore.EmailCampaign.Model]],  Sitecore.Framework.Messaging.Abstractions"
        implementationType="Sitecore.EmailCampaign.Cm.UI.Handlers.UnsubscribeMessageHandler, Sitecore.EmailCampaign.Cm.UI"
        lifetime="Transient">
        <patch:attribute name="implementationType">Sitecore.Support.EmailCampaign.Cm.UI.Handlers.UnsubscribeMessageHandler, Sitecore.Support.255287.255621</patch:attribute>
      </register>
      <register role:require="!DedicatedDispatch"
        serviceType="Sitecore.Framework.Messaging.IMessageHandler`1[[Sitecore.EmailCampaign.Model.Messaging.SubscribeMessage, Sitecore.EmailCampaign.Model]],  Sitecore.Framework.Messaging.Abstractions"
        implementationType="Sitecore.EmailCampaign.Cm.UI.Handlers.SubscribeMessageHandler, Sitecore.EmailCampaign.Cm.UI"
        lifetime="Transient">
        <patch:attribute name="implementationType">Sitecore.Support.EmailCampaign.Cm.UI.Handlers.SubscribeMessageHandler, Sitecore.Support.255287.255621</patch:attribute>
      </register>
      <register
        serviceType="Sitecore.Framework.Messaging.IMessageHandler`1[[Sitecore.EmailCampaign.Model.Messaging.ConfirmSubscriptionMessage, Sitecore.EmailCampaign.Model]],  Sitecore.Framework.Messaging.Abstractions"
        implementationType="Sitecore.EmailCampaign.Cm.UI.Handlers.ConfirmSubscriptionMessageHandler, Sitecore.EmailCampaign.Cm.UI"
        lifetime="Transient">
        <patch:attribute name="implementationType">Sitecore.Support.EmailCampaign.Cm.UI.Handlers.ConfirmSubscriptionMessageHandler, Sitecore.Support.255287.255621</patch:attribute>
      </register>
    </services>
    <Messaging>
      <Rebus>
        <Sitecore.EmailCampaign.Model.Messaging.Buses.UnsubscribeMessagesBus role:require="!DedicatedDispatch">
          <Routing>
            <TypeBasedMappings>
              <TypeMappings>
                <UnsubscribeMessageMapping>
                  <Type>Sitecore.Support.EmailCampaign.Model.Messaging.UnsubscribeMessage, Sitecore.Support.255287.255621</Type>
                </UnsubscribeMessageMapping>
              </TypeMappings>
            </TypeBasedMappings>
          </Routing>
        </Sitecore.EmailCampaign.Model.Messaging.Buses.UnsubscribeMessagesBus>
        <Sitecore.EmailCampaign.Model.Messaging.Buses.SubscribeMessagesBus role:require="!DedicatedDispatch">
          <Routing>
            <TypeBasedMappings>
              <TypeMappings>
                <SubscribeMessageMapping>
                  <Type>Sitecore.Support.EmailCampaign.Model.Messaging.SubscribeMessage, Sitecore.Support.255287.255621</Type>
                </SubscribeMessageMapping>
              </TypeMappings>
            </TypeBasedMappings>
          </Routing>
        </Sitecore.EmailCampaign.Model.Messaging.Buses.SubscribeMessagesBus>
        <Sitecore.EmailCampaign.Model.Messaging.Buses.ConfirmSubscriptionMessagesBus role:require="!DedicatedDispatch">
          <Routing>
            <TypeBasedMappings>
              <TypeMappings>
                <ConfirmSubscriptionMessageMapping>
                  <Type>Sitecore.Support.EmailCampaign.Model.Messaging.ConfirmSubscriptionMessage, Sitecore.Support.255287.255621</Type>
                </ConfirmSubscriptionMessageMapping>
              </TypeMappings>
            </TypeBasedMappings>
          </Routing>
        </Sitecore.EmailCampaign.Model.Messaging.Buses.ConfirmSubscriptionMessagesBus>
      </Rebus>
    </Messaging>
  </sitecore>
</configuration>